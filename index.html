<!DOCTYPE html>
<html>
<body>

<h2>Login</h2>

<input id="email" placeholder="email" type="email">
<input id="password" type="password" placeholder="password">

<button onclick="login()">Entrar</button>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
// 1. Inicializar el cliente con un nombre distinto para evitar errores
const _supabase = window.supabase.createClient(
  "https://cglpqxwuleilocifwuma.supabase.co",
  "sb_publishable_vDeRR2vZXRpRgZVHSKArwQ_EuCD0poY"
);

// 2. üîê LOGIN
async function login() {
  console.log("Intentando login...");

  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  // Usamos el cliente con el nuevo nombre _supabase
  const { data, error } = await _supabase.auth.signInWithPassword({
    email: email,
    password: password
  });

  if (error) {
    console.error("Error detallado:", error);
    alert("Error: " + error.message);
    return;
  }

  console.log("Datos de sesi√≥n:", data);
  alert("Login correcto");
  window.location.href = "panel.html";
}

// 3. ‚úÖ VERIFICAR SESI√ìN
async function verificarSesion() {
  const { data, error } = await _supabase.auth.getSession();
  if (data?.session) {
    console.log("Sesi√≥n activa detectada");
    window.location.href = "panel.html";
  }
}

verificarSesion();
</script>

</body>
</html>
